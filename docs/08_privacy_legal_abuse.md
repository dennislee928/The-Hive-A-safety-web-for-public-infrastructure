# Privacy, Legal, and Abuse Controls

本文件定義隱私、法律與濫用防護的詳細規格，包含風險註冊表、資料處理規範、濫用情境分析與緩解措施。

## 隱私優先設計原則（Privacy-by-Design）

### 核心原則

1. **區域級聚合優先**
   - 所有信號在到達決策層前進行區域級聚合
   - 不進行個別人員的精確定位
   - 僅保留時間窗口摘要，不保留原始個別資料

2. **避免持續追蹤**
   - 不使用連續位置追蹤
   - 僅使用時間窗口摘要（60-120 秒窗口）
   - 不建立個別人員的移動軌跡

3. **資料最小化**
   - 僅收集決策所需的最少資料
   - 定期清理過期資料
   - 資料保留期限明確定義

4. **存取控制與審計**
   - 所有資料存取需授權
   - 所有資料存取記錄於審計日誌
   - 審計日誌不可變更

---

## 資料處理規範

### 資料項目清單

#### 1. 基礎設施信號資料

**資料類型**：
- 區域級流量計數（進出人次）
- 環境感測器資料（煙霧、溫度、異常震動）
- 設備狀態資料（手扶梯、電梯、列車狀態）

**合法基礎**（台灣 PDPA）：
- **第 19 條第 1 項第 2 款**：為增進公共利益所必要（公共安全）

**目的限制**：
- 僅用於安全決策與應變
- 不用於商業用途或個別追蹤

**保留期限**：
- 即時資料：不保留（僅用於決策）
- 聚合摘要：90 天（用於分析與改善）
- 審計日誌：1 年

**匿名化處理**：
- 區域級聚合（不包含個別識別資訊）
- 時間窗口摘要（不包含精確時間戳）

---

#### 2. 人員信號資料

**資料類型**：
- 人員識別碼（雜湊處理）
- 報告內容（結構化文字）
- 報告時間戳與位置（區域級）

**合法基礎**（台灣 PDPA）：
- **第 19 條第 1 項第 2 款**：為增進公共利益所必要（公共安全）
- **第 19 條第 1 項第 6 款**：當事人同意（人員報告）

**目的限制**：
- 僅用於安全決策與應變
- 不用於人員績效評估或個別追蹤

**保留期限**：
- 即時資料：不保留（僅用於決策）
- 聚合摘要：90 天（用於分析與改善）
- 審計日誌：1 年

**匿名化處理**：
- 人員識別碼雜湊處理（不可逆）
- 報告內容去識別化（移除個人資訊）

---

#### 3. 緊急通話資料

**資料類型**：
- 通話識別碼（雜湊處理）
- 通話類型（醫療、安全、火災、其他）
- 粗略位置（區域級，不包含精確座標）
- 通話時間戳

**合法基礎**（台灣 PDPA）：
- **第 19 條第 1 項第 2 款**：為增進公共利益所必要（公共安全）
- **第 19 條第 1 項第 4 款**：為防止他人權益之重大危害（緊急應變）

**目的限制**：
- 僅用於緊急應變與安全決策
- 不用於個別追蹤或商業用途

**保留期限**：
- 即時資料：不保留（僅用於決策）
- 事件記錄：30 天（符合緊急應變需求）
- 審計日誌：1 年

**匿名化處理**：
- 通話識別碼雜湊處理（不可逆）
- 粗略位置（區域級，不包含精確座標）

---

#### 4. 群眾信號資料（Route 2 App）

**資料類型**：
- 裝置識別碼（雜湊處理）
- 報告內容（結構化文字）
- 報告時間戳與位置（區域級）
- 信任評分（系統計算）

**合法基礎**（台灣 PDPA）：
- **第 19 條第 1 項第 1 款**：當事人同意（App 使用者同意）
- **第 19 條第 1 項第 2 款**：為增進公共利益所必要（公共安全）

**目的限制**：
- 僅用於安全決策與應變
- 不用於個別追蹤或商業用途

**保留期限**：
- 即時資料：不保留（僅用於決策）
- 聚合摘要：90 天（用於信任評分計算與分析）
- 審計日誌：1 年

**匿名化處理**：
- 裝置識別碼雜湊處理（不可逆）
- 報告內容去識別化（移除個人資訊）
- 僅保留區域級聚合統計

---

#### 5. 操作日誌資料

**資料類型**：
- 操作人員識別碼（雜湊處理）
- 操作動作（決策點狀態轉換、資料存取）
- 操作時間戳
- 操作理由（結構化文字）

**合法基礎**（台灣 PDPA）：
- **第 19 條第 1 項第 2 款**：為增進公共利益所必要（公共安全、審計需求）

**目的限制**：
- 僅用於審計與系統改善
- 不用於人員績效評估或個別追蹤

**保留期限**：
- 操作日誌：1 年（符合審計需求）
- 審計日誌：1 年

**匿名化處理**：
- 操作人員識別碼雜湊處理（不可逆）
- 操作理由去識別化（移除個人資訊）

---

### 資料處理流程

**收集階段**：
- 僅收集決策所需的最少資料
- 即時進行區域級聚合
- 不保留原始個別資料

**處理階段**：
- 所有資料處理在授權環境內進行
- 所有資料存取記錄於審計日誌
- 資料處理結果去識別化

**儲存階段**：
- 資料加密儲存（傳輸中與靜止時）
- 資料存取需授權（雙因子認證）
- 定期清理過期資料

**刪除階段**：
- 保留期限到期後自動刪除
- 刪除動作記錄於審計日誌
- 刪除後資料不可恢復

---

## 風險註冊表

使用 [templates/risk_register_template.md](../templates/risk_register_template.md) 格式：

| 風險 | 類別 | 可能性 | 影響 | 控制措施 | 殘餘風險 | 負責人 |
|------|------|--------|------|----------|----------|--------|
| 群眾報告濫用（Spam/Flooding） | Abuse | 中 | 中 | 速率限制（每裝置每小時最多 3 筆）+ 佐證要求 | 低 | Abuse Agent |
| 協調性濫用（Coordinated Brigading） | Abuse | 低 | 高 | 跨來源佐證 + 時間窗口檢查 + 異常檢測 | 中 | Abuse Agent |
| 誤報誘發恐慌（False-Flagging） | Abuse | 低 | 高 | 雙人控制 + 死手保持 + CAP 一致性檢查 | 低 | Abuse Agent |
| 未授權廣播誘發恐慌（Panic Induction） | Abuse | 低 | 高 | 雙人控制 + 死手保持 + 通道隔離 + 數位簽章 | 低 | Abuse Agent |
| 信號偽造（Signal Forgery） | Integrity | 中 | 高 | 信號來源驗證 + 硬體完整性檢查 + 跨來源佐證 | 中 | Systems Architect Agent |
| 命令偽造（Command Forgery） | Integrity | 低 | 高 | 數位簽章 + 雙人控制 + 審計日誌 | 低 | Systems Architect Agent |
| 資料外洩（Data Breach） | Privacy | 低 | 高 | 資料加密 + 存取控制 + 審計日誌 | 低 | Privacy & Legal Agent |
| 個別追蹤（Individual Tracking） | Privacy | 中 | 中 | 區域級聚合 + 時間窗口摘要 + 資料最小化 | 低 | Privacy & Legal Agent |
| 資料保留違規（Retention Violation） | Privacy | 低 | 中 | 自動清理機制 + 審計日誌 | 低 | Privacy & Legal Agent |
| 存取控制繞過（Access Control Bypass） | Privacy/Integrity | 低 | 高 | 雙因子認證 + 審計日誌 + 異常檢測 | 低 | Systems Architect Agent |
| 系統性偏見（Systematic Bias） | Bias | 中 | 中 | 信號來源多樣性 + 定期審計 + 權重調整 | 中 | Governance / ERH Agent |
| 漏報風險（False Negative） | Safety | 中 | 高 | 降低佐證閾值 + 增加信號來源 + 縮短時間窗口 | 中 | Governance / ERH Agent |
| 誤報風險（False Positive） | Safety | 中 | 中 | 提高佐證閾值 + 雙人控制 + 人工審核 | 中 | Governance / ERH Agent |

**風險等級定義**：
- **可能性**：低（< 10%）、中（10-50%）、高（> 50%）
- **影響**：低（可接受）、中（需注意）、高（需立即行動）
- **殘餘風險**：低（可接受）、中（需監控）、高（需進一步緩解）

---

## 濫用情境分析

### 1. 群眾報告濫用（Spam/Flooding）

**攻擊向量**：
- 單一裝置或少量裝置大量提交報告（例如：每分鐘 10 筆）
- 目的：癱瘓系統、製造假警報、消耗系統資源

**攻擊影響**：
- 系統資源消耗增加
- 決策層信號雜訊增加
- 可能觸發誤報（FP-prime 增加）

**緩解措施**：
- **速率限制**：每裝置每小時最多 3 筆報告
- **佐證要求**：群眾報告需與其他信號來源佐證（見 [docs/04_signal_model.md](04_signal_model.md)）
- **信任評分**：濫用裝置的信任評分降低（見 [docs/04_signal_model.md](04_signal_model.md)）
- **異常檢測**：檢測異常報告頻率，標記為「需人工檢視」

**技術規格**：
- 速率限制參數：`max_reports_per_device_per_hour = 3`
- 速率限制窗口：滑動窗口（每小時）
- 異常檢測閾值：報告頻率 > 5 筆/小時（標記為異常）

---

### 2. 協調性濫用（Coordinated Brigading）

**攻擊向量**：
- 多個裝置協調提交相似報告（例如：同一區域、同一時間窗口）
- 目的：製造假警報、觸發誤報、操縱決策

**攻擊影響**：
- 可能觸發誤報（FP-prime 增加）
- 可能操縱決策（觸發不必要的升級）
- 可能誘發恐慌

**緩解措施**：
- **跨來源佐證**：群眾報告需與基礎設施或人員信號佐證（見 [docs/04_signal_model.md](04_signal_model.md)）
- **時間窗口檢查**：檢查報告時間窗口是否異常集中
- **異常檢測**：檢測協調性模式（例如：多個裝置同時提交相似報告）
- **信任評分**：協調性濫用裝置的信任評分降低

**技術規格**：
- 佐證閾值：至少 1 個其他獨立來源（基礎設施或人員）
- 時間窗口檢查：報告時間窗口異常集中（標準差 < 30 秒）標記為異常
- 異常檢測閾值：同一時間窗口內 > 10 個裝置提交相似報告（標記為異常）

---

### 3. 誤報誘發恐慌（False-Flagging）

**攻擊向量**：
- 提交虛假報告，觸發系統升級或公開警告
- 目的：誘發恐慌、破壞公共秩序、消耗應變資源

**攻擊影響**：
- 可能觸發誤報（FP-prime 增加）
- 可能誘發恐慌
- 可能消耗應變資源

**緩解措施**：
- **雙人控制**：高影響決策（D3/D4/D5）需雙人控制批准（見 [docs/03_decision_points.md](03_decision_points.md)）
- **死手保持**：高影響決策需持續保持（keepalive），超時自動回滾
- **CAP 一致性檢查**：公開警告（D5）需 CAP 一致性檢查（見 [docs/05_route1_baseline.md](05_route1_baseline.md)）
- **佐證要求**：高影響決策需至少 2 個獨立信號來源佐證

**技術規格**：
- 雙人控制要求：2 名授權操作人員獨立認證
- 死手保持間隔：60 秒
- 死手保持超時：120 秒（超過則自動回滾）
- 佐證閾值：至少 2 個獨立來源

---

### 4. 未授權廣播誘發恐慌（Panic Induction）

**攻擊向量**：
- 入侵公開警告通道（cell broadcast、SMS、PA），發布虛假警告
- 目的：誘發恐慌、破壞公共秩序

**攻擊影響**：
- 可能誘發恐慌
- 可能破壞公共秩序
- 可能造成人員傷亡（踩踏事件）

**緩解措施**：
- **雙人控制**：公開警告（D5）需雙人控制批准
- **死手保持**：公開警告需持續保持（keepalive），超時自動回滾
- **通道隔離**：公開警告通道與其他系統隔離
- **數位簽章**：所有公開警告需數位簽章驗證
- **一致性檢查**：所有通道的警告內容需一致（基於 CAP 標準格式）

**技術規格**：
- 雙人控制要求：2 名授權操作人員獨立認證
- 死手保持間隔：60 秒
- 死手保持超時：120 秒（超過則自動回滾）
- 數位簽章演算法：RSA-2048 或 ECDSA-P256（符合 NIST 標準）
- 一致性檢查：所有通道的 CAP 訊息內容需完全一致

---

## 緩解措施技術規格

### 速率限制（Rate Limiting）

**參數設定**：
- **群眾報告**：每裝置每小時最多 3 筆
- **人員報告**：每人每小時最多 10 筆（較高，因為是可信來源）
- **緊急通話**：無限制（緊急情況）

**實作方式**：
- 滑動窗口計數器（每小時）
- 超過限制時，拒絕報告並記錄於審計日誌

**降級處理**：
- 速率限制系統故障時，降級至手動審核模式

---

### 佐證閾值（Corroboration Thresholds）

**參數設定**：
- **低影響決策**（D0/D1/D2）：建議佐證，但不強制
- **高影響決策**（D3/D4/D5）：強制要求至少 2 個獨立來源佐證

**實作方式**：
- 檢查同一時間窗口內、同一區域的獨立信號來源數量
- 獨立性檢查：排除相關信號（例如：同一裝置的多筆報告）
- 一致性檢查：信號內容需一致（允許時間差異 ± 5 分鐘）

**降級處理**：
- 佐證不足時，自動降級決策等級（例如：從 D3 降至 D2）

---

### 審計日誌格式

**日誌項目**：
- 時間戳（ISO8601 格式）
- 操作類型（資料存取、決策點狀態轉換、系統配置）
- 操作人員識別碼（雜湊處理）
- 操作目標（資料項目、決策點、系統組件）
- 操作結果（成功/失敗）
- 操作理由（結構化文字，可選）

**日誌儲存**：
- 加密儲存（傳輸中與靜止時）
- 不可變更（寫入後不可修改）
- 保留期限：1 年

**日誌存取**：
- 僅授權審計人員可存取
- 所有日誌存取記錄於審計日誌（遞迴審計）

---

## 台灣 PDPA 對應條款

### 資料收集（第 19 條）

**適用條款**：
- **第 1 項第 1 款**：當事人同意（App 使用者同意）
- **第 1 項第 2 款**：為增進公共利益所必要（公共安全）
- **第 1 項第 4 款**：為防止他人權益之重大危害（緊急應變）
- **第 1 項第 6 款**：當事人同意（人員報告）

**實作方式**：
- App 使用者需明確同意資料收集（同意書）
- 人員報告需明確同意（工作規範）
- 基礎設施與緊急通話資料基於公共利益與緊急應變需求

---

### 資料處理（第 20 條）

**適用條款**：
- **第 1 項**：資料處理需符合收集目的
- **第 2 項**：資料處理需採取適當安全措施

**實作方式**：
- 資料處理僅用於安全決策與應變（符合收集目的）
- 資料加密、存取控制、審計日誌（適當安全措施）

---

### 資料保留（第 21 條）

**適用條款**：
- **第 1 項**：資料保留期限需明確
- **第 2 項**：保留期限到期後需刪除

**實作方式**：
- 各資料項目的保留期限明確定義（見上方「資料處理規範」）
- 保留期限到期後自動刪除（自動清理機制）

---

### 當事人權利（第 3 條）

**適用條款**：
- **第 1 項**：當事人有權查詢、閱覽、複製、補充、更正、停止收集、處理、利用或刪除其個人資料

**實作方式**：
- 提供當事人權利行使機制（例如：App 內設定、客服管道）
- 當事人請求需在 30 天內處理（符合 PDPA 要求）

---

## 假設

- 所有資料處理符合台灣 PDPA 要求
- 所有緩解措施可有效實施
- 審計日誌系統正常運作

## 攻擊考量

- 速率限制繞過：需裝置識別碼驗證與異常檢測
- 佐證閾值操縱：需跨來源驗證與時間窗口檢查
- 審計日誌偽造：需數位簽章與完整性驗證

## 隱私影響

- 所有資料處理遵循隱私優先設計原則
- 所有資料去識別化處理
- 所有資料存取記錄於審計日誌
